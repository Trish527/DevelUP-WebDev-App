<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markup Museum</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link rel="icon" type="image/x-icon" href="assets/museum-favicon.png">
</head>

<body>
    <audio id="bgMusic" loop>
        <source src="assets/bgm1.mp3" type="audio/mpeg" />
        Your browser does not support the audio element.
    </audio>
    <audio id="cappuccinoTrack">
        <source src="assets/Cappuccino.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <audio id="ballerinaTrack">
        <source src="assets/Ballerina.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <audio id="chimpanziniTrack">
        <source src="assets/chimpanzini.mp3" type="audio/mpeg">
    </audio>

    <audio id="tungtungTrack">
        <source src="assets/tungtung.mp3" type="audio/mpeg">
    </audio>

    <audio id="liriliTrack">
        <source src="assets/lirili.mp3" type="audio/mpeg">
    </audio>

    <audio id="lavacaTrack">
        <source src="assets/lavaca.mp3" type="audio/mpeg">
    </audio>


    <button id="musicToggle" class="music-control">
        <i class="fas fa-volume-up"></i>
    </button>

    <!-- Replace the fragment counter div with this -->
    <div class="fragment-counter">
        <div class="fragment-display">
            <!-- Empty slots will be filled with puzzle images as fragments are collected -->
        </div>
    </div>

    <!-- ENTRANCE -->
    <section class="entrance visible" id="entrance-section">
        <div class="entrance-container">
            <div class="entrance-content">
                <div class="entrance-wrapper">
                    <img src="assets/hallway.png" alt="placeholder" class="entrance-open" id="hallway-img">

                    <div id="left-door" class="door">
                        <div class="shape"></div>
                        <div class="shape"></div>
                        <div id="left-knob" class="knob"></div>
                    </div>

                    <div id="right-door" class="door">
                        <div class="shape"></div>
                        <div class="shape"></div>
                        <div id="right-knob" class="knob"></div>
                    </div>
                </div>
                <div class="barrier">
                    <img src="assets/barrier2.png" class="barrier1">
                    <img src="assets/barrier2.png" class="barrier2">
                </div>
            </div>
        </div>
    </section>

    <!-- LOBBY -->
    <section class="lobby hidden" id="lobby-section">
        <div class="lobby-container">
            <div class="lobby-content">
                <div class="lobby-layer">
                    <img src="assets/portrait-room.png" alt="placeholder" class="portrait-room" id="portrait-room">
                    <img src="assets/souvenir-room.png" alt="placeholder" class="souvenir-room" id="souvenir-room">
                    <img src="assets/sculpture-room.png" alt="placeholder" class="sculpture-room" id="sculpture-room">
                    <img src="assets/theater-room.png" alt="placeholder" class="theater-room" id="theater-room">
                </div>
            </div>
        </div>
    </section>

    <!-- PORTRAIT ROOM -->
    <section class="portrait hidden" id="portrait-section">
        <div class="portrait-container">
            <div class="portrait-content">
                <button class="map-button">
                    <img src="assets/Map-button.png" alt="Map">
                </button>
                <div class="portrait-layer" class="divReal" id="FA-1">


                    <div class="divReal" id="FA-1">
                        <img src="assets/puzzle-placeholder.png" class="puzzle1" id="puzzle-1">
                    </div>

                    <img src="assets/cappuccino-assassino.png" class="portrait-picture1">
                    <img src="assets/ballerina-cappuccina.png" class="portrait-picture2">
                    <img src="assets/frame1.png" class="portrait-picture1">
                    <img src="assets/frame1.png" class="portrait-picture2">
                    <img src="assets/picture1.jpg" class="portrait-picture3">
                    <img src="assets/picture2.png" class="portrait-picture4">
                    <img src="assets/window.png" class="portrait-window1">
                    <img src="assets/barrier2.png" class="portrait-barrier1">
                    <img src="assets/barrier2.png" class="portrait-barrier2">
                    <img src="assets/portrait-plant.png" class="portrait-plant1">
                    <img src="assets/portrait-plant.png" class="portrait-plant2">
                    <img src="assets/portrait-wall.png" class="portrait-wall1">
                    <img src="assets/portrait-wall.png" class="portrait-wall2">
                    <img src="assets/frame2.png" class="portrait-picture5">
                    <img src="assets/frame2.png" class="portrait-picture6">
                    <img src="assets/picture3.jpg" class="portrait-picture7">
                    <img src="assets/picture4.png" class="portrait-picture8">
                    <img src="assets/portrait-light.png" class="portrait-light1">
                    <img src="assets/portrait-light.png" class="portrait-light2">
                    <img src="assets/portrait-plant.png" class="portrait-plant3">
                    <img src="assets/portrait-plant.png" class="portrait-plant4">
                    <img src="assets/portrait-plant.png" class="portrait-plant5">
                    <img src="assets/portrait-plant.png" class="portrait-plant6">
                </div>
            </div>
        </div>
        </div>
    </section>

    <!-- SCULPTURE ROOM -->
    <section class="sculpture hidden" id="sculpture-section">
        <div class="sculpture-container">
            <div class="sculpture-content">
                <button class="map-button">
                    <img src="assets/Map-button.png" alt="Map">
                </button>
                <div class="sculpture-layer">
                    <img src="assets/chimpanzini-bananini.png" class="sculpture-picture1">
                    <img src="assets/sculpture-picture2.png" class="sculpture-picture2">
                    <img src="assets/sculpture1.png" class="sculpture-picture3">
                    <img src="assets/barrier.png" class="sculpture-barrier">
                    <img src="assets/assets/sword-shield.png" class="sculpture-picture4">
                    <img src="assets/axe.png" class="sculpture-picture5">
                    <img src="assets/sculpture-picture3.png" class="sculpture-picture6">
                    <img src="assets/sculpture-picture3.png" class="sculpture-picture7">
                    <img src="assets/sculpture-picture3.png" class="sculpture-picture8">
                    <img src="assets/sculpture-picture3.png" class="sculpture-picture9">
                    <img src="assets/sculpture-picture4.png" class="sculpture-picture10">
                    <img src="assets/sculpture-picture5.png" class="sculpture-picture11">
                    <img src="assets/sculpture-picture6.png" class="sculpture-picture12">
                    <img src="assets/sculpture-picture7.png" class="sculpture-picture13">

                    <div class="divReal" id="FA-4">
                        <img src="assets/puzzle-placeholder.png" class="puzzle4" id="puzzle-4">
                    </div>

                </div>
            </div>
        </div>
    </section>

    <!-- THEATER ROOM -->
    <section class="theater hidden" id="theater-section">
        <div class="theater-container">
            <div class="theater-content">
                <button class="map-button">
                    <img src="assets/Map-button.png" alt="Map">
                </button>
                <div class="theater-layer">
                    <img src="assets/TungTungTungSahur.png" class="theater-picture1">
                    <img src="assets/lirili-larila.png" class="theater-picture2">
                    <div class="theater-backcurtain">
                        <img src="assets/theater-curtain.png" class="theater-picture3">

                        <div class="divReal" id="FA-3">
                            <img src="assets/puzzle-placeholder.png" class="puzzle3" id="puzzle-3">
                        </div>

                    </div>
                    <img src="assets/theater-curtain1.png" class="theater-picture4">
                    <img src="assets/theater-curtain1.png" class="theater-picture5">
                    <img src="assets/theater-curtain1.png" class="theater-picture6">
                    <img src="assets/theater-curtain1.png" class="theater-picture7">
                    <img src="assets/theater-curtain1.png" class="theater-picture8">
                    <img src="assets/theater-curtain2.png" class="theater-picture9">
                    <img src="assets/theater-curtain3.png" class="theater-picture10">
                    <img src="assets/theater-chair.png" class="theater-picture11">
                    <img src="assets/theater-chair.png" class="theater-picture12">
                    <img src="assets/theater-chair.png" class="theater-picture13">
                    <img src="assets/theater-chair.png" class="theater-picture14">
                    <img src="assets/theater-chair.png" class="theater-picture15">
                    <img src="assets/theater-chair.png" class="theater-picture16">
                    <img src="assets/theater-chair.png" class="theater-picture17">
                    <img src="assets/theater-chair.png" class="theater-picture18">
                    <img src="assets/theater-chair.png" class="theater-picture19">
                    <img src="assets/theater-chair.png" class="theater-picture20">
                    <div class="theater-chair">
                        <img src="assets/theater-chair.png" class="theater-picture21">
                        <div class="divReal" id="FA-4">
                            <img src="assets/puzzle-placeholder.png" class="puzzle2" id="puzzle-2">
                        </div>
                    </div>
                    <img src="assets/clothes1.png" class="theater-clothes1">
                    <img src="assets/clothes2.png" class="theater-clothes2">
                    <img src="assets/clothes8.png" class="theater-clothes3">
                    <img src="assets/clothes3.png" class="theater-clothes4">
                    <img src="assets/clothes5.png" class="theater-clothes5">
                    <img src="assets/clothes6.png" class="theater-clothes6">
                    <img src="assets/clothes7.png" class="theater-clothes7">
                </div>

            </div>
        </div>
    </section>

    <!-- SOUVENIR SHOP -->
    <section class="souvenir hidden" id="souvenir-section">
        <div class="souvenir-container">
            <div class="souvenir-content">
                <button class="map-button">
                    <img src="assets/Map-button.png" alt="Map">
                </button>
                <div class="souvenir-layer">
                    <img src="assets/La-vaca-Saturno-Saturnita.png" class="souvenir-picture1">
                    <img src="assets/souvenir-jewelry.png" class="souvenir-picture2">
                    <img src="assets/souvenir-counter.png" class="souvenir-picture3">
                    <img src="assets/souvenir-cabinet.png" class="souvenir-picture4">
                    <img src="assets/souvenir-cabinet.png" class="souvenir-picture5">
                    <img src="assets/souvenir-sculpture1.png" class="souvenir-picture6">
                    <img src="assets/souvenir-book.png" class="souvenir-picture7">
                    <img src="assets/souvenir-book.png" class="souvenir-picture8">
                    <img src="assets/souvenir-sculpture2.png" class="souvenir-picture9">
                    <img src="assets/souvenir-sculpture3.png" class="souvenir-picture10">
                    <img src="assets/souvenir-chest.png" class="souvenir-picture11">
                    <img src="assets/souvenir-fossil.png" class="souvenir-picture12">
                    <img src="assets/souvenir-fossil.png" class="souvenir-picture13">
                    <img src="assets/souvenir-frame.png" class="souvenir-picture14">
                    <img src="assets/souvenir-frame.png" class="souvenir-picture15">
                    <img src="assets/souvenir-globe.png" class="souvenir-picture16">
                    <img src="assets/souvenir-bottle.png" class="souvenir-picture17">
                    <img src="assets/souvenir-bottle.png" class="souvenir-picture18">
                    <img src="assets/souvenir-bottle.png" class="souvenir-picture19">
                    <img src="assets/souvenir-postcards.png" class="souvenir-picture20">
                    <img src="assets/souvenir-postcards.png" class="souvenir-picture21">
                    <img src="assets/souvenir-clothes.png" class="souvenir-picture22">
                    <img src="assets/souvenir-clothes2.png" class="souvenir-picture23">
                    <div class="divReal" id="FA-5">
                        <img src="assets/puzzle-placeholder.png" class="puzzle5" id="puzzle-5">
                    </div>
                    <div class="divReal" id="FA-6">
                        <img src="assets/puzzle-placeholder.png" class="puzzle6" id="puzzle-6">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- VICTORY SCREEN  -->
    <section class="victory hidden" id="victory-section">
        <div class="victory-container">
            <div class="victory-content">
                <div class="victory-layer">
                    <img src="assets/victory-frame.png" class="victory-frame">
                </div>
            </div>
        </div>
    </section>

    <script>
        // Entrance to Lobby
        document.getElementById('hallway-img').addEventListener('click', function () {
            const entrance = document.getElementById('entrance-section');
            const lobby = document.getElementById('lobby-section');

            entrance.classList.remove('visible');
            entrance.classList.add('hidden');

            setTimeout(() => {
                lobby.classList.remove('hidden');
                lobby.classList.add('visible');
            }, 1000);
        });

        // Lobby to Portrait 
        document.getElementById('portrait-room').addEventListener('click', function () {
            const lobby = document.getElementById('lobby-section');
            const portrait = document.getElementById('portrait-section');

            lobby.classList.remove('visible');
            lobby.classList.add('hidden');

            setTimeout(() => {
                portrait.classList.remove('hidden');
                portrait.classList.add('visible');
            }, 1000);
        });

        // Lobby to Sculpture 
        document.getElementById('sculpture-room').addEventListener('click', function () {
            const lobby = document.getElementById('lobby-section');
            const sculpture = document.getElementById('sculpture-section');

            lobby.classList.remove('visible');
            lobby.classList.add('hidden');

            setTimeout(() => {
                sculpture.classList.remove('hidden');
                sculpture.classList.add('visible');
            }, 1000);
        });

        // Lobby to Theater 
        document.getElementById('theater-room').addEventListener('click', function () {
            const lobby = document.getElementById('lobby-section');
            const theater = document.getElementById('theater-section');

            lobby.classList.remove('visible');
            lobby.classList.add('hidden');

            setTimeout(() => {
                theater.classList.remove('hidden');
                theater.classList.add('visible');
            }, 1000);
        });

        // Lobby to Souvenir 
        document.getElementById('souvenir-room').addEventListener('click', function () {
            const lobby = document.getElementById('lobby-section');
            const souvenir = document.getElementById('souvenir-section');

            lobby.classList.remove('visible');
            lobby.classList.add('hidden');

            setTimeout(() => {
                souvenir.classList.remove('hidden');
                souvenir.classList.add('visible');
            }, 1000);
        });

        let puzzle1Clicked = false;
        let puzzle2Clicked = false;
        let puzzle3Clicked = false;
        let puzzle4Clicked = false;
        let puzzle5Clicked = false;
        let puzzle6Clicked = false;
        const puzzle1 = document.getElementById('puzzle-1');
        const puzzle2 = document.getElementById('puzzle-2');
        const puzzle3 = document.getElementById('puzzle-3');
        const puzzle4 = document.getElementById('puzzle-4');
        const puzzle5 = document.getElementById('puzzle-5');
        const puzzle6 = document.getElementById('puzzle-6');

        if (puzzle1 && puzzle2 && puzzle3 && puzzle4 && puzzle5 && puzzle6) {
            puzzle1.addEventListener('click', function () {
                if (!puzzle1Clicked) {
                    console.log('Puzzle 1 clicked');
                    puzzle1Clicked = true;
                    puzzle1.style.pointerEvents = "none";
                    checkSouvenirPuzzlesClicked();
                }
            });

            puzzle2.addEventListener('click', function () {
                if (!puzzle2Clicked) {
                    console.log('Puzzle 2 clicked');
                    puzzle2Clicked = true;
                    puzzle2.style.pointerEvents = "none";
                    checkSouvenirPuzzlesClicked();
                }
            });


            puzzle3.addEventListener('click', function () {
                if (!puzzle3Clicked) {
                    console.log('Puzzle 3 clicked');
                    puzzle3Clicked = true;
                    puzzle3.style.pointerEvents = "none";
                    checkSouvenirPuzzlesClicked();
                }
            });

            puzzle4.addEventListener('click', function () {
                if (!puzzle4Clicked) {
                    console.log('Puzzle 4 clicked');
                    puzzle4Clicked = true;
                    puzzle4.style.pointerEvents = "none";
                    checkSouvenirPuzzlesClicked();
                }
            });

            puzzle5.addEventListener('click', function () {
                if (!puzzle5Clicked) {
                    console.log('Puzzle 5 clicked');
                    puzzle5Clicked = true;
                    puzzle5.style.pointerEvents = "none";
                    checkSouvenirPuzzlesClicked();
                }
            });

            puzzle6.addEventListener('click', function () {
                if (!puzzle6Clicked) {
                    console.log('Puzzle 6 clicked');
                    puzzle6Clicked = true;
                    puzzle6.style.pointerEvents = "none";
                    checkSouvenirPuzzlesClicked();
                }
            });
        }

        function checkSouvenirPuzzlesClicked() {
            if (puzzle1Clicked && puzzle2Clicked && puzzle3Clicked && puzzle4Clicked && puzzle5Clicked && puzzle6Clicked) {
                const sections = ['portrait-section', 'sculpture-section', 'theater-section', 'souvenir-section', 'lobby-section'];
                const victory = document.getElementById('victory-section');

                for (let id of sections) {
                    const section = document.getElementById(id);
                    if (section && section.classList.contains('visible')) {
                        section.classList.remove('visible');
                        section.classList.add('hidden');
                        setTimeout(() => {
                            victory.classList.remove('hidden');
                            victory.classList.add('visible');
                        }, 1000);
                        return;
                    }
                }

                console.error('No active section found to transition from!');
            }
        }

    </script>

    <script>
        // Website Background Music
        const bgMusic = document.getElementById("bgMusic");
        const musicToggle = document.getElementById("musicToggle");
        let isMusicPlaying = false;

        // Function to toggle music (mute on or off)
        function toggleMusic() {
            if (isMusicPlaying) {
                bgMusic.pause();
                musicToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
            } else {
                bgMusic.play();
                musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
            }
            isMusicPlaying = !isMusicPlaying;
        }

        // Add click event to toggle button
        document.addEventListener("DOMContentLoaded", function () {
            // Initialize music muted
            bgMusic.volume = 0.5;
            bgMusic.muted = true;

            musicToggle.addEventListener("click", function () {
                bgMusic.muted = !bgMusic.muted;

                if (bgMusic.muted) {
                    bgMusic.pause();
                    musicToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
                } else {
                    bgMusic.play().catch(err => console.error("Play failed:", err));
                    musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                }
            });
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const cappuccinoImg = document.querySelector('img[src="assets/cappuccino-assassino.png"]');
            const ballerinaImg = document.querySelector('img[src="assets/ballerina-cappuccina.png"]');
            const cappuccinoAudio = document.getElementById('assets/cappuccinoTrack');
            const ballerinaAudio = document.getElementById('assets/ballerinaTrack');

            // Reset everything to safe defaults
            [cappuccinoAudio, ballerinaAudio].forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });

            // Set click cursor
            cappuccinoImg.style.cursor = "pointer";
            ballerinaImg.style.cursor = "pointer";

            // Add click-only handlers
            cappuccinoImg.addEventListener("click", () => {
                cappuccinoAudio.currentTime = 0;
                cappuccinoAudio.play().catch(e => console.warn("Cappuccino play error:", e));
            });

            ballerinaImg.addEventListener("click", () => {
                ballerinaAudio.currentTime = 0;
                ballerinaAudio.play().catch(e => console.warn("Ballerina play error:", e));
            });
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const bgMusic = document.getElementById("bgMusic");

            const clickAudioPairs = [
                { selector: 'img[src="assets/cappuccino-assassino.png"]', audioId: 'cappuccinoTrack' },
                { selector: 'img[src="assets/allerina-cappuccina.png"]', audioId: 'ballerinaTrack' },
                { selector: 'img[src="assets/chimpanzini-bananini.png"]', audioId: 'chimpanziniTrack' },
                { selector: 'img[src="assets/TungTungTungSahur.png"]', audioId: 'tungtungTrack' },
                { selector: 'img[src="assets/lirili-larila.png"]', audioId: 'liriliTrack' },
                { selector: 'img[src="assets/La-vaca-Saturno-Saturnita.png"]', audioId: 'lavacaTrack' }
            ];

            // Get all audio elements
            const allAudio = clickAudioPairs.map(pair => document.getElementById(pair.audioId));
            allAudio.push(bgMusic); // include bgMusic in the group to pause

            // Add click event listeners
            clickAudioPairs.forEach(pair => {
                const img = document.querySelector(pair.selector);
                const audio = document.getElementById(pair.audioId);

                if (img && audio) {
                    img.style.cursor = "pointer";

                    img.addEventListener("click", () => {
                        // Stop all other audio
                        allAudio.forEach(a => {
                            if (!a.paused) a.pause();
                            a.currentTime = 0;
                        });

                        // Play selected track
                        audio.play().catch(e => console.warn(`${pair.audioId} play failed:`, e));

                        // When it ends, resume bgMusic
                        audio.onended = () => {
                            bgMusic.play().catch(e => console.warn("bgMusic resume failed:", e));
                        };
                    });
                }
            });
        });
        // Map Button Functionality
        document.addEventListener("DOMContentLoaded", function () {
            const mapButtons = document.querySelectorAll('.map-button');

            mapButtons.forEach(button => {
                button.addEventListener('click', function () {
                    // Hide all sections
                    document.querySelectorAll('section').forEach(section => {
                        section.classList.remove('visible');
                        section.classList.add('hidden');
                    });

                    // Show entrance/lobby section
                    const entranceSection = document.getElementById('lobby-section');
                    entranceSection.classList.remove('hidden');
                    entranceSection.classList.add('visible');
                });
            });
        });
    </script>

    <script>
        //Fragmenter Portion
        var recent_file;
        fetch('http://localhost:3000/recent-file')
            .then(response => response.json())
            .then(data => {
                recent_file = data.recentFile;
                console.log(recent_file);
                fragmentImage(recent_file);
            })
            .catch(error => {
                console.error('Error:', error);
        });
            

        // Fragment Collection System with Victory Screen
        document.addEventListener("DOMContentLoaded", function () {
            const fragmentDisplay = document.querySelector('.fragment-display');
            let fragmentsCollected = 0;
            
            // Create empty slots for all fragments
            for (let i = 0; i < 6; i++) {
                const fragmentSlot = document.createElement('img');
                fragmentSlot.src = 'assets/puzzle-placeholder.png';
                fragmentSlot.alt = 'Fragment';
                fragmentSlot.dataset.index = i;
                fragmentDisplay.appendChild(fragmentSlot);
            }

            // Get all puzzle elements
            const puzzles = [
                document.getElementById('puzzle-1'),  // Portrait Room
                document.getElementById('puzzle-2'),  // Theater Room (FA-4)
                document.getElementById('puzzle-3'),  // Theater Room (FA-3)
                document.getElementById('puzzle-4'),  // Sculpture Room
                document.getElementById('puzzle-5'),  // Souvenir Shop (FA-5)
                document.getElementById('puzzle-6')   // Souvenir Shop (FA-6)
            ];

            // Track collected puzzles
            const collectedPuzzles = Array(puzzles.length).fill(false);

            // Handle puzzle clicks
            puzzles.forEach((puzzle, index) => {
                if (puzzle) {
                    puzzle.addEventListener('click', function () {
                        if (!collectedPuzzles[index]) {
                            // Mark as collected
                            collectedPuzzles[index] = true;
                            fragmentsCollected++;

                            // Update display
                            const fragmentSlots = document.querySelectorAll('.fragment-display img');
                            fragmentSlots[fragmentsCollected - 1].classList.add('collected');

                            // Visual feedback
                            this.style.transform = 'scale(1.2)';
                            setTimeout(() => {
                                this.style.transform = 'scale(1)';
                            }, 300);

                            // Fade out puzzle
                            this.style.opacity = '0';
                            setTimeout(() => {
                                this.style.display = 'none';
                            }, 1000);

                            // Check for victory
                            if (fragmentsCollected === 6) {
                                // Celebration animation
                                fragmentSlots.forEach(slot => {
                                    slot.style.animation = 'celebrate 0.5s ease-in-out 3';
                                });

                                // Show victory screen after a delay
                                setTimeout(() => {
                                    const sections = [
                                        'portrait-section',
                                        'sculpture-section',
                                        'theater-section',
                                        'souvenir-section',
                                        'lobby-section'
                                    ];

                                    const victory = document.getElementById('victory-section');

                                    // Hide all current sections
                                    sections.forEach(id => {
                                        const section = document.getElementById(id);
                                        if (section && section.classList.contains('visible')) {
                                            section.classList.remove('visible');
                                            section.classList.add('hidden');
                                        }
                                    });

                                    // Show victory screen
                                    setTimeout(() => {
                                        victory.classList.remove('hidden');
                                        victory.classList.add('visible');
                                    }, 1000);

                                }, 2000); // Wait for celebration animation to complete
                            }
                        }
                    });
                }
            });
        });

        function fragmentImage(imagePath) {
            const fragmentCount = 6;
            const image = new Image();
            image.src = '/Images/' + recent_file;
            image.crossOrigin = "anonymous"; // if needed

            image.onload = function () {
                const width = image.width;
                const height = image.height;
                const fragmentHeight = height / fragmentCount;

                for (let i = 0; i < fragmentCount; i++) {
                    const canvas = document.createElement("canvas");
                    canvas.width = width;
                    canvas.height = fragmentHeight;

                    const ctx = canvas.getContext("2d");
                    ctx.drawImage(
                        image,
                        0, i * fragmentHeight,   // Source x, y
                        width, fragmentHeight,   // Source w, h
                        0, 0,                    // Dest x, y
                        width, fragmentHeight    // Dest w, h
                    );

                    const fragmentDataUrl = canvas.toDataURL("image/png");
                    const imgElement = document.getElementById(`puzzle-${i + 1}`);
                    if (imgElement) {
                        imgElement.src = fragmentDataUrl;
                        imgElement.alt = `Puzzle Piece ${i + 1}`; // Fix accessibility warning
                    }
                }
            };

            image.onerror = function () {
                console.error("Failed to load source image:", imagePath);
        };
    }

  
    </script>
</body>

</html>